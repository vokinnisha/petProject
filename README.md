# Проект: Система управления библиотекой

## Стек технологий и библиотек
- [X] Server: NestJS
- [X] module: `pg`, `class-validator`,  `class-transformer`
- [Х] NestJs Monorepo
## Описание

Данный тренировочный проект направлен на создание системы управления библиотекой, позволяющей отслеживать процесс аренды книг. В основе системы лежит каталог `database`, который содержит три основные сущности - `Пользователи`, `Книги` и `Аренда`. 

Реализация проекта осуществляется с использованием PostgreSQL без применения ORM, что позволяет повысить навыки работы с SQL и проверить собственные знания программирования на JavaScript.

## Запуск:

- Запустите Docker с помощью команды: `docker compose up -d`

- Запустите проект в режиме разработчика с помощью команды: `npm run start:dev modules`

## Тестирование:

### Создание новой книги:

Примеры JSON для создания новой книги

1. Запрос:

```json
{
    "title": "Властелин колец",
    "author": "Дж. Р. Р. Толкиен",
    "genre": "Фэнтези",
    "publicationYear": "1954-07-29",
    "available": 2
}
```

2. Запрос:

```json
{
    "title": "1984",
    "author": "Джордж Оруэлл",
    "genre": "Научная фантастика",
    "publicationYear": "1949-06-08",
    "available": 0
}
```

### Создание нового пользователя:

Примеры JSON для создания нового пользователя

1. Запрос:

```json
{
    "firstName": "Иван",
    "lastName": "Иванов",
    "email": "ivanov@mail.com",
    "phone": "+79991112233",
    "socialLogin": "ivanov123",
    "birthDate": "1988-03-25"
}
```

2. Запрос:

```json
{
    "firstName": "Мария",
    "lastName": "Петрова",
    "email": "petrova@mail.com",
    "phone": "+79994445566",
    "socialLogin": "mariapetrova",
    "birthDate": "1990-07-15"
}
```

### Аренда книг:

Примеры JSON для аренды книг

1. Запрос:

```json
{
    "bookId": 1,
    "customerId": 2,
    "dateRented": "2022-02-10",
    "dateReturned": "2022-03-01"
}
```

2. Запрос:

```json
{
    "bookId": 2,
    "customerId": 1,
    "dateRented": "2022-01-20",
    "dateReturned": "2022-02-05"
}
```

Если вы попытаетесь арендовать книгу, которой нет в наличии, вы получите ошибку.

## Что уже сделано

- Созданы и описаны модели данных для `Пользователей`, `Книг`, `Аренды`.
- Разработан пул соединений для работы с базой данных и функция для выполнения SQL-запросов.
- Построены три таблицы соответственно для каждой сущности.
- Реализована система связей между таблицами. При этом происходит проверка наличия данных пользователей и книг.
- Проведены мероприятия по предотвращению SQL-инъекций.
- В процессе аренды реализована система транзакций.
- Добавлены новые параметры для каждой сущности 19.11.2023
- Использовал триггер и функцию для создания clientId 

## Что осталось сделать

#### SQL:

- [ ] Реализовать JOIN для аренды, позволяющий получать информацию о пользователе или книге.
- [ ] Реализовать функцию обновления данных пользователя.
- [ ] Реализовать механизм удаления\update старых данных об аренде.
- [ ] Разработать функционал для поиска определенной книги или автора.
- [ ] Разрабатывать отчеты о наиболее популярных жанрах и активных читателях.
- [ ] Реализовать триггер для автоматического изменения количества свободных книг.
- [ ] Создать представление с полной информацией об аренде.
- [ ] Создать процедуру для автоматического удаления записей о возвращенных книгах спустя год после возврата.
- [ ] Провести работы по ACID, обеспечивая Consistency и Atomicity транзакций.
- [ ] Создать систему индексов для оптимизации работы системы.
- [ ] Разработать операции ALERT & DROP.

#### Безопасность:

- [ ] Усилить защиту от SQL / XSS / XXE-инъекций.
- [ ] Внедрить симметричное и/или ассиметричное шифрование данных.

#### Объектно-Ориентированное Программирование (ООП) и паттерны проектирования:

- [ ] Разработать свой логгер, применяя паттерн проектирования "Синглтон".
- [ ] Применить паттерн "Прокси" в модуле обслуживающем сущность "Пользователь".
- [ ] Следовать принципам проектирования программного обеспечения KISS, DRY, YAGNI, или всем трем одновременно для повышения гибкости, легкости и надежности приложения.

## Заключение

В рамках реализации тренировочного проекта планируется постоянное его совершенствование и добавление нового функционала для обеспечения наивысшего уровня удобства работы с системой "Библиотека". При этом основной упор будет сделан на использование навыков работы с SQL и JavaScript/TypeScript.
